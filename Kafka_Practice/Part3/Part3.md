# Kafka 살펴보기
## Apache Kafka란?
- 오픈 소스 기반의  Event Streaming 플랫폼
- 여러 대의 분산 서버에서 대량의 데이터를 처리하는 분산 메시징 시스템
- 발행/ 구독 메시지 전달 패턴 사용
  - 발행자(발행하는 쪽)는 메시지(데이터)를 직접 수신자(구독하는 쪽)로 보내지 않음
  - 발행자는 어떤 형태로든 메시지를 분류해서 보내고, 수신자는 이렇게 분류된 메시지를 구독
  - 보통 발행된 메시지를 전달받고 중계해주는 중간 지점을 하는 브로커가 존재
  - TV 방속국과 TV의 관계와 비슷
  - 브로커가 없는 경우
    - ex) 프론트엔드 서버로 부터 app지표(사용자수, 클릭수 등)들을 모아 모니터링하는 지표 서버(구독자)
    - 모니터링을 시작하는 시점에는 발행자, 구독자가 직접 통신하도록 하느 간단한 해법
    - 만약 여러 서비스들로부터 여러 지표들을 모으도록 기능이 확장된다면 소프트웨어의 복잡도가 N*M 만큼 복잡해질 수 있음
      > N: 발행자 개수, M: 구독자 개수
    - 변경, 에러에 취약
  - 브로커가 있는 경우
    - 소프트웨어의 복잡도가 N*M 에서 N+M으로 감소
    - 발행자, 구독자가 서로에 대해 의존할 필요가 없음. 모두 브로커와만 접속하면 됨
    - 발해앚, 구독자가 추가, 제거 되더라도 기존 발행자, 구독자들은 영향을 받지 않음
      - 변경에 강함
  - 발행잔는 브로커에 메시지를 보내기만 할 뿐, 누가 메시지를 이용하는지 신경쓰지 않음
  - 발행자가 보내는 메시지는 브로커 내의 토픽에 등록됨
  - 구독자는 브로커 내의 토픽에서 자신이 관심 있는 것 만을 선택
  - 같은 토픽을 구독하느 여러 구독자에게는 동일한 메시지가 전달됨
- Apache Kafka의 주요 특징
  1. 높은 처리량으로 실시간 처리
  2. 확장성 : 처리하는 데이터 양에 따라 scale-out을 용이하게 함
  3. 영속성 : 수신한 데이터를 디스크에 유지하며, 임의의 시저멩 데이터를 읽을 수 있음
  4. 유연성 : 연계할 수 있는 시스템이 많아 여러 시스템들을 연결하는 허브 역할 가능
  5. 신뢰 : 메시지 전달 보증을 하므로 데이터 분실을 걱정할 필요가 없음
- Apache Kafka의 사용 분야
  1. 데이터 허브 : 여러 시스템 사이에서 데이터를 상호 교환
  2. 로그 수집 : BI도구를 이용한 리포팅, 머신러닝 분석을 위해 여러 서버에서 생성되는 로그들을 수집 및 축적
  3. 웹 활동 분석 : 실시간 대시보드와 이상치/ 부정 검출 등 웹에서의 사용자 활동을 실시간으로 추적
  4. 사물인터넷 : 센서 등 다양한 디바이스에서 보낸 데이터를 수신해 처리한 후 디바이스에 송신
  5. 이벤트 소싱 : 데이터에 대한 일련의 이벤트를 순차적으로 기록하고 CQRS 방식으로 대량의 이벤트르 유연하게 처리
- Kafka의 주요 구성 요소
  - Producer(발행자)
    - Connector가 붙어 있음(MySQL 같은 외부 시스템, API, 라이브러리 등)
  - Connect API를 통해 broker에 데이터를 전달
  - broker안 topic에 전달된 데이터는 Consumer(구독자)가 데이터를 읽어옴
  - cluster에 broker를 관리하는 Zookeeper가 있음